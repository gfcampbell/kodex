"use strict";(()=>{var e={};e.id=252,e.ids=[252],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},2048:e=>{e.exports=require("fs")},5315:e=>{e.exports=require("path")},6533:(e,t,s)=>{s.r(t),s.d(t,{originalPathname:()=>w,patchFetch:()=>g,requestAsyncStorage:()=>l,routeModule:()=>p,serverHooks:()=>f,staticGenerationAsyncStorage:()=>m});var i={};s.r(i),s.d(i,{GET:()=>c,POST:()=>d});var r=s(2711),a=s(8380),n=s(3023),o=s(5098),u=s(4835);async function c(e){let t=e.nextUrl.searchParams,s=t.get("path"),i=t.get("status"),r=t.get("topic"),a=t.get("search");if(!s)return o.NextResponse.json({error:"Path parameter is required"},{status:400});try{let e=await (0,u.zj)(s),t=e.items;if(i&&(t=t.filter(e=>e.status===i)),r&&(t=t.filter(e=>e.topic.startsWith(r))),a){let e=a.toLowerCase();t=t.filter(t=>t.title.toLowerCase().includes(e)||t.content.toLowerCase().includes(e)||t.topic.toLowerCase().includes(e))}return t.sort((e,t)=>new Date(t.generatedAt).getTime()-new Date(e.generatedAt).getTime()),o.NextResponse.json({items:t,total:e.items.length})}catch(e){return console.error("Failed to load docs:",e),o.NextResponse.json({error:"Failed to load documentation"},{status:500})}}async function d(e){try{let{path:t,action:s}=await e.json();if(!t)return o.NextResponse.json({error:"Path is required"},{status:400});if("scan"!==s)return o.NextResponse.json({error:"Invalid action"},{status:400});return o.NextResponse.json({success:!0,generated:0,updated:0,skipped:0,message:"Scan functionality will be integrated with CLI"})}catch(e){return console.error("Failed to scan:",e),o.NextResponse.json({error:"Failed to scan codebase"},{status:500})}}let p=new r.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/docs/route",pathname:"/api/docs",filename:"route",bundlePath:"app/api/docs/route"},resolvedPagePath:"/Users/assistant/Github/kodex/packages/dashboard/app/api/docs/route.ts",nextConfigOutput:"",userland:i}),{requestAsyncStorage:l,staticGenerationAsyncStorage:m,serverHooks:f}=p,w="/api/docs/route";function g(){return(0,n.patchFetch)({serverHooks:f,staticGenerationAsyncStorage:m})}},4835:(e,t,s)=>{s.d(t,{B7:()=>f,UZ:()=>w,cE:()=>m,hk:()=>l,zj:()=>d});var i=s(2048),r=s(5315),a=s.n(r);let n="items.json",o="gaps.json";function u(e){return a().join(e,".kodex")}async function c(e){let t=u(e);await i.promises.mkdir(t,{recursive:!0}),await i.promises.mkdir(a().join(t,"docs"),{recursive:!0})}async function d(e){let t=u(e),s=[],r=[];try{let e=a().join(t,n),r=await i.promises.readFile(e,"utf-8");s=JSON.parse(r).items||[]}catch{}try{let e=a().join(t,o),s=await i.promises.readFile(e,"utf-8");r=JSON.parse(s).gaps||[]}catch{}return{items:s,gaps:r,meta:{name:"Knowledge Base",version:"1.0.0"}}}async function p(e,t){await c(e);let s=u(e),r=a().join(s,n);await i.promises.writeFile(r,JSON.stringify({items:t.items,meta:t.meta},null,2),"utf-8");let d=a().join(s,o);await i.promises.writeFile(d,JSON.stringify({gaps:t.gaps},null,2),"utf-8")}async function l(e,t){return(await d(e)).items.find(e=>e.id===t)||null}async function m(e,t,s){let i=await d(e),r=i.items.findIndex(e=>e.id===t);return -1===r?null:(i.items[r]={...i.items[r],...s,lastEditedAt:new Date().toISOString()},await p(e,i),i.items[r])}async function f(e,t){let s=await d(e),i=s.items.findIndex(e=>e.id===t);return -1!==i&&(s.items.splice(i,1),await p(e,s),!0)}async function w(e,t){await c(e);let s=a().join(u(e),"docs"),r=t.topic.split(".")[0],n=a().join(s,r);await i.promises.mkdir(n,{recursive:!0});let o=`${t.id}.md`,d=a().join(n,o),p=`---
id: ${t.id}
title: ${t.title}
topic: ${t.topic}
pages: ${JSON.stringify(t.pages)}
status: ${t.status}
---

`;await i.promises.writeFile(d,p+t.content,"utf-8")}}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),i=t.X(0,[991,189],()=>s(6533));module.exports=i})();