"use strict";(()=>{var e={};e.id=633,e.ids=[633],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},2048:e=>{e.exports=require("fs")},5315:e=>{e.exports=require("path")},9440:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>g,patchFetch:()=>f,requestAsyncStorage:()=>c,routeModule:()=>d,serverHooks:()=>m,staticGenerationAsyncStorage:()=>l});var i={};r.r(i),r.d(i,{POST:()=>p});var a=r(2711),s=r(8380),n=r(3023),o=r(5098),u=r(4835);async function p(e){try{let{path:t,itemId:r}=await e.json();if(!t)return o.NextResponse.json({error:"Path is required"},{status:400});if(!r)return o.NextResponse.json({error:"Item ID is required"},{status:400});if(!await (0,u.hk)(t,r))return o.NextResponse.json({error:"Document not found"},{status:404});let i=await (0,u.cE)(t,r,{generatedAt:new Date().toISOString(),status:"draft",humanEdited:!1});return i&&await (0,u.UZ)(t,i),o.NextResponse.json({success:!0,item:i,message:"Regeneration will be integrated with CLI generator"})}catch(e){return console.error("Failed to regenerate:",e),o.NextResponse.json({error:"Failed to regenerate document"},{status:500})}}let d=new a.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/regenerate/route",pathname:"/api/regenerate",filename:"route",bundlePath:"app/api/regenerate/route"},resolvedPagePath:"/Users/assistant/Github/kodex/packages/dashboard/app/api/regenerate/route.ts",nextConfigOutput:"",userland:i}),{requestAsyncStorage:c,staticGenerationAsyncStorage:l,serverHooks:m}=d,g="/api/regenerate/route";function f(){return(0,n.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:l})}},4835:(e,t,r)=>{r.d(t,{B7:()=>g,UZ:()=>f,cE:()=>m,hk:()=>l,zj:()=>d});var i=r(2048),a=r(5315),s=r.n(a);let n="items.json",o="gaps.json";function u(e){return s().join(e,".kodex")}async function p(e){let t=u(e);await i.promises.mkdir(t,{recursive:!0}),await i.promises.mkdir(s().join(t,"docs"),{recursive:!0})}async function d(e){let t=u(e),r=[],a=[];try{let e=s().join(t,n),a=await i.promises.readFile(e,"utf-8");r=JSON.parse(a).items||[]}catch{}try{let e=s().join(t,o),r=await i.promises.readFile(e,"utf-8");a=JSON.parse(r).gaps||[]}catch{}return{items:r,gaps:a,meta:{name:"Knowledge Base",version:"1.0.0"}}}async function c(e,t){await p(e);let r=u(e),a=s().join(r,n);await i.promises.writeFile(a,JSON.stringify({items:t.items,meta:t.meta},null,2),"utf-8");let d=s().join(r,o);await i.promises.writeFile(d,JSON.stringify({gaps:t.gaps},null,2),"utf-8")}async function l(e,t){return(await d(e)).items.find(e=>e.id===t)||null}async function m(e,t,r){let i=await d(e),a=i.items.findIndex(e=>e.id===t);return -1===a?null:(i.items[a]={...i.items[a],...r,lastEditedAt:new Date().toISOString()},await c(e,i),i.items[a])}async function g(e,t){let r=await d(e),i=r.items.findIndex(e=>e.id===t);return -1!==i&&(r.items.splice(i,1),await c(e,r),!0)}async function f(e,t){await p(e);let r=s().join(u(e),"docs"),a=t.topic.split(".")[0],n=s().join(r,a);await i.promises.mkdir(n,{recursive:!0});let o=`${t.id}.md`,d=s().join(n,o),c=`---
id: ${t.id}
title: ${t.title}
topic: ${t.topic}
pages: ${JSON.stringify(t.pages)}
status: ${t.status}
---

`;await i.promises.writeFile(d,c+t.content,"utf-8")}}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),i=t.X(0,[991,189],()=>r(9440));module.exports=i})();